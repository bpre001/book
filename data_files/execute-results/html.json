{
  "hash": "8cab15919c6c680eed825d15c2c087ce",
  "result": {
    "engine": "knitr",
    "markdown": "# Data\n\n## Goal\n\nThe objective of this project is to produce 3-day forecasts of net energy use for the Cohaus residential development of 20 apartments at 11-13 Surrey Crescent, Grey Lynn, Auckland.\n\n## Data Source\n\nCohaus was completed in July 2021 and teh community moved in shortly thereafter,, Cohaus has installed solar generation capacity that is applied locally, and if any surplus remains is sold back to the electricity retailer. The data for this project has been collected from the residential development itself (of which the author is an owner-resident). Half hourly kWh electricity use and generation measures are as follows:\n\n-   `APT` aggregated apartment electricity use\n\n-   `CS` common services (lighting, laundry, bike shed, garden house)\n\n-   `EV` electric vehicle chargers\n\n-   `HP` centralised hot water and heat pumps\n\n-   `PV` photo-voltaic electricity generation\n\nNet energy use (i.e. drawn from the grid) is calculated by summing the five measures.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(fpp3)\nlibrary(GGally)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# read in cohaus_wide (painful wrangle is in separate wrangle.R)\ncohaus_wide <- read_rds(\"data/cohaus_wide.rds\")\n\ncohaus_long <- cohaus_wide |> \n  pivot_longer(cols = -dttm, names_to = \"Name\", values_to = \"Value\")\n\ncohaus_ts <- cohaus_wide |> as_tsibble(index = dttm)\n```\n:::\n\n::: {.cell messages='false'}\n\n```{.r .cell-code}\ncohaus_ts |> \n  gg_tsdisplay(PV, plot_type = \"partial\")\n```\n\n::: {.cell-output-display}\n![](data_files/figure-html/plots-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncohaus_wide |> \n  select(APT,EV,CS,HP,PV) |> \n  ggpairs(progress = FALSE)\n```\n\n::: {.cell-output-display}\n![](data_files/figure-html/plots-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncohaus_wide |> \n  select(Sink,PV,AT) |> \n  ggpairs(progress = FALSE)\n```\n\n::: {.cell-output-display}\n![](data_files/figure-html/plots-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nqtrDummy <- function(x,y) {\n  ifelse(quarter(x) == y, 1, 0)\n}\n\ncohaus_ts <- cohaus_ts |> \n  mutate(qtr1 = qtrDummy(dttm,1),\n         qtr2 = qtrDummy(dttm,2),\n         qtr3 = qtrDummy(dttm,3),\n         qtr4 = qtrDummy(dttm,4)\n         )\n\ncohaus_ts |>\n  ggplot(aes(x = hour(dttm), y = -PV)) +\n  geom_point(alpha = 0.1, col = \"gold\") +\n  facet_wrap(~month(dttm))\n```\n\n::: {.cell-output-display}\n![](data_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncohaus_ts |>\n  ggplot(aes(x = hour(dttm), y = Sink)) +\n  geom_point(alpha = 0.1, col = \"blue\") +\n  facet_wrap(~month(dttm))  \n```\n\n::: {.cell-output-display}\n![](data_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncohaus_ts |>\n  ggplot(aes(x = hour(dttm), y = Tdry)) +\n  geom_point(alpha = 0.05, col = \"red\") +\n  facet_wrap(~month(dttm))  \n```\n\n::: {.cell-output-display}\n![](data_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\nfit <- cohaus_ts |>\n  model(snaive = SNAIVE(PV ~ lag(\"week\")),\n        lm = TSLM(PV ~ season() + qtr2 + qtr3 + qtr4 + workDay + sunUp + Tdry)\n        )\n\nfit |> select(.model = lm) |> report()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: PV \nModel: TSLM \n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.1933  -2.1550   0.4275   2.0934  18.5465 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     2.58810    0.27189   9.519  < 2e-16 ***\nseason()day2   -0.06072    0.22645  -0.268 0.788615    \nseason()day3   -0.11177    0.22665  -0.493 0.621915    \nseason()day4   -0.16148    0.22656  -0.713 0.476011    \nseason()day5   -0.19760    0.22662  -0.872 0.383259    \nseason()day6   -0.21803    0.22666  -0.962 0.336107    \nseason()day7   -0.46375    0.22702  -2.043 0.041082 *  \nseason()day8   -2.45551    0.24723  -9.932  < 2e-16 ***\nseason()day9   -6.38545    0.28123 -22.705  < 2e-16 ***\nseason()day10 -10.69363    0.28137 -38.005  < 2e-16 ***\nseason()day11 -14.49122    0.28206 -51.376  < 2e-16 ***\nseason()day12 -17.01445    0.28290 -60.143  < 2e-16 ***\nseason()day13 -18.18177    0.28349 -64.136  < 2e-16 ***\nseason()day14 -17.90846    0.28380 -63.102  < 2e-16 ***\nseason()day15 -16.68659    0.28391 -58.774  < 2e-16 ***\nseason()day16 -13.96247    0.28369 -49.218  < 2e-16 ***\nseason()day17 -10.23029    0.28313 -36.133  < 2e-16 ***\nseason()day18  -6.49669    0.28237 -23.008  < 2e-16 ***\nseason()day19  -3.05869    0.25185 -12.145  < 2e-16 ***\nseason()day20  -0.87966    0.24510  -3.589 0.000333 ***\nseason()day21  -0.10984    0.23496  -0.467 0.640151    \nseason()day22   0.22306    0.22668   0.984 0.325101    \nseason()day23   0.13701    0.22653   0.605 0.545311    \nseason()day24   0.06236    0.22646   0.275 0.783027    \nqtr2            2.92212    0.10729  27.236  < 2e-16 ***\nqtr3            1.80965    0.12545  14.426  < 2e-16 ***\nqtr4           -0.35285    0.09682  -3.645 0.000269 ***\nworkDayTRUE    -0.04380    0.06999  -0.626 0.531473    \nsunUpTRUE       1.02438    0.16743   6.118 9.66e-10 ***\nTdry           -0.24079    0.01122 -21.464  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.5 on 18928 degrees of freedom\nMultiple R-squared: 0.7185,\tAdjusted R-squared: 0.7181\nF-statistic:  1666 on 29 and 18928 DF, p-value: < 2.22e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nfit |> select(.model = snaive) |> \n  forecast(h = 24*3) |> \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](data_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}